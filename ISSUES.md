# hmPS プロジェクトの問題点

このドキュメントは `hmPS` プロジェクトの現状分析と、それに伴う問題点をまとめたものです。

## 1. バージョン管理の問題 (Version Control Issues)

- **ビルド成果物の混入:**
  - リポジトリ内に、ソースコードから生成されるべきビルド成果物（`.dll`, `.obj`, `.lib`, `.pdb`など）が多数含まれています。
  - これにより、リポジトリのサイズが不必要に肥大化しています。
  - また、どのソースコードがどのバイナリに対応するのかが不明確になり、バージョン管理を困難にしています。
- **`.gitignore`の不備:**
  - 本来バージョン管理から除外すべきビルド成果物や、個人の開発環境に依存するファイル (`.user`, `.tlog`など) が管理対象となっています。
  - 適切な `.gitignore` ファイルを作成し、リポジトリをクリーンな状態に保つ必要があります。

## 2. ビルドプロセスの問題 (Build Process Issues)

- **ドキュメントの欠如:**
  - プロジェクトをビルドするための手順がドキュメント化されていません。
  - `VS2017.md` ファイルは存在しますが、中身が空です。
  - 公式ウェブサイト上の「開発環境」の項目もリンク切れとなっており、第三者がビルドを再現することが非常に困難です。
- **古い開発環境への依存:**
  - プロジェクトファイル (`.sln`, `.vcxproj`) や依存関係から、開発環境として **Visual Studio 2017** が想定されていることが推測されます。
  - VS2017 は現在サポートが終了しており、セキュリティリスクや、最新のOS環境でのビルドが困難になる可能性があります。
  - プロジェクトを最新のVisual Studio（例: 2022）でビルドできるように移行することが望まれます。

## 3. 手動で複雑なインストール (Manual and Complex Installation)

- **手動でのファイル配置:**
  - 利用者は、秀丸エディタのビット数（32bit/64bit）に合わせて正しいzipファイルをダウンロードし、展開した中から `hmPS.dll` と `hmPS.ps1` を手動で `hidemaru.exe` と同じディレクトリにコピーする必要があります。
- **インストーラの不在:**
  - 上記のプロセスは手動であり、特にPCに不慣れな利用者にとっては間違いやすいプロセスです。
  - インストーラを提供することで、導入のハードルを大幅に下げることができます。

## 4. パフォーマンスの問題 (Performance Issues)

- **初回起動の遅延:**
  - `README.md` や公式サイトでも言及されている通り、PowerShellを利用する関係上、初回の呼び出しが非常に遅いという問題があります。
- **手動での対策が必要:**
  - `ngen.exe` (Native Image Generator) を使ってネイティブイメージを事前に作成することが推奨されていますが、これも利用者が手動でコマンドを実行する必要があり、一般的な対策とは言えません。

## 5. メンテナンス性の問題 (Maintenance Issues)

- **巨大なラッパーファイル:**
  - `hmPS.ps1` は、秀丸エディタのマクロ関数をPowerShellに公開するためのラッパー関数が数百行にわたって記述されています。
  - 秀丸エディタ本体のAPIに変更があった場合、このファイルを正確に手動で更新する必要があり、非常に手間がかかり、バグの温床となりやすい構造です。
- **自動テストの欠如:**
  - プロジェクト内に単体テストや結合テストといった自動テストの仕組みが見当たりません。
  - これにより、リファクタリングや機能追加、不具合の修正が、意図しない別の箇所に影響（リグレッション）を与えていないかを確認することが困難になっています。

## 6. 古い依存関係 (Dependency Issues)

- **.NET Framework 4.5 への依存:**
  - C#プロジェクト (`hmPSStaticLib`) は、古い `.NET Framework 4.5` に依存しています。
  - より新しい.NET（例: .NET 8）へ移行することで、パフォーマンスの向上、最新の言語機能の利用、長期的なメンテナンス性の確保などが期待できますが、C++/CLIとの連携部分を含め、移行には相応の作業が必要となります。
